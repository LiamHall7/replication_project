---
title: "GOV 52: Replication Project"
author: "Liam Hall"
date: "`r format(Sys.time(), '%Y %B %d')`"
output:
  pdf_document: default
  html_document: default
header-includes:
    - \usepackage{setspace}\doublespacing
    - \usepackage{float}
indent: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_chunk$set(fig.pos = "!H", out.extra = "")

library(tidyverse)
library(readr)
library(arm)
library(dplyr)
library(foreign)
library(haven)
library(ggplot2)
library(ggthemes)
library(extrafont)
library(stringr)
library(janitor)
library(stargazer)
library(dynamac)
library(tseries)
library(urca)
library(forecast)
library(TSstudio)
library(aTSA)
library(ARDL)
library(msm)
library(ggpubr)
library(boot)
library(grid)
library(gridExtra)
library(gtable)
library(xtable)
library(astsa)
library(knitr)
library(broom)
library(kableExtra)

```

## Introduction

The original paper *The Dynamic American Dream*, coauthored by Jennifer Wolak and David A.M. Peterson (2020) and published in the *American Journal of Political Science*^[The replication data was available through the Harvard dataverse. You can access the files [here](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/QTMOVG).], analyzes behavior of belief in the American dream over time, and as it relates to economic inequality, social mobility, home ownership, public policy mood (that is, the public demand for liberal policy outcomes), consumer confidence, and the presence of U.S. midterm and presidential elections. The condition of the American dream has long been seen as a barometer of America's perceived condition - a measure of optimism in America's future - and American politicians on both sides of the aisle have historically appealed to the American Dream when discussing their vision of the nation. When times are good, the American Dream is alive as ever. When times are tough, politicians insist that change must happen, that we "need to write a new chapter in American Dream" and "bring it back bigger and stronger and more powerfully than ever before." Wolak and Peterson take a more objective approach in assessing the dynamics of the American Dream. Instead of relying on abstract terms, the authors aggregate responses from quarterly surveys of American citizens from 1973 to 2018 to quantify the percentage of Americans who believe the American Dream is achievable, exploring its dynamics relative to temporal economic, social, and political conditions. Further, the authors explore the responsiveness of belief in the American Dream to these short-term variables in the long run, displaying their findings in both numerical and graphical mediums.

## Model Replication and Interpretations

Because the model's variables - belief in the American dream, economic inequality, social mobility, home ownership, public policy mood (that is, the public demand for liberal policy outcomes), consumer confidence, and the presence of U.S. midterm and presidential elections - include both stationary and non-stationary cointegrated time series, the authors employed a generalized error correction model (GECM) that is able to effectively combine these different variables (Bannerjee et al. 1993; DeBoef and Keele 2008). Because of the high correlation between social mobility and economic inequality, the authors split the data into two models, one with the gini coefficient variable and one with the social mobility variable, but which are otherwise identical. The GECM model, like the auto-regressive distributed lag model, uses the equation: $$\Delta y_{t} = \alpha_{0} + \alpha_{1}y_{t-1} + \beta_{0}\Delta x_{t} + \epsilon_{t}$$ Extending the findings from the GECM models, the original paper also looks at the extent to which the non-stationary explanatory variables have a long run relationship with belief in the American dream, as reflected by long run multipliers and their respective t-values. Ultimately, the authors found statistically significant, positive correlations between belief in the American dream and social mobility, home ownership, and consumer confidence (measured by index of consumer sentiment) and a statistically significant, negative relationship between belief in the American Dream and economic inequality. Intuitively, these findings make sense, because as the economy becomes more lopsided and social mobility wanes, Americans are naturally less optimistic about opportunity in America. Interestingly, the authors also find a positive relationship between election cycles and belief in the American dream, suggesting that non-policy political influences might increase Americans' national optimism, too, however these findings are inconsistently significant.

In this replication, I translate the originally-Latex paper into R and reconstruct the plots and models of the original authors in their entirety. Because variable stationarity affects the GECM model structure, I diverge from the original paper to explore and confirm the stationarity of the variables used in the original GECM model to confirm the model was properly constructed. I also bootstrap the model errors and display the distribution of belief changes in the American dream between time periods (that is, I show how much belief in the American dream changes between time periods to see if the fluctuations might be due to slight variations of human error).

My replication of the models ultimately yielded the same numerical values and, therefore, the same conclusions as the original paper. I explain the different calculations and interpret some of model outputs with some visual aids I constructed from the data. 

The model reconstruction was relatively straightforward. I manually created the lag and delta variables, by using the previous time period's values and taking the change in value between consecutive time periods, and input these newly-created variables in the GECM. Because these GECM variables were all calculated manually, I was able to use the lm() function, as opposed to some of the GECM specific functions within the ecm and ARDL packages. Thus, my GECM took the form of a linear regression of the lagged and delta non-stationary variables and the original stationary variables. This yielded the coefficient, standard error, and p-value statistics that are displayed in Table 1. Extending from the original models, I also bootstrapped the variables' standard errors and output them in table 2. 

The long run multipliers were calculated with the equation $LRM_{x} = - \beta_{x}/\alpha_{1}$, with inputs taken from the GECM model outputs. There are two primary ways to calculate the standard errors of long run multipliers: the delta method and the Bewley transformation, which yield asymptotically accurate values (Nieman & Petersen, 2019). Because the two methods are roughly equal in accuracy, I used the delta method, which used the model covariance and the LRM value to calculate the LRM standard errors. The respective LRM t-values were simply the ratio of the LRM to the LRM's standard error ($LRM_{x}/\epsilon_{_{LRM_x}}$). These methods were also used by the original authors and yielded the same results as the original paper.

Looking at top half of the model outputs, we can see a lagged home ownership coefficient for the first model of .932 and a delta coefficient of .877. With this, we would expect that a 1% increase in the home ownership rate, all else equal, would increase belief in the American Dream by 2.4 percent. Looking at the LRM values, we can interpret that, for example, an increase of 0.00525 in the gini coefficient (which was the largest between quarters) would lead to a .57 percent decline in belief in the American dream.

Figure 3 plots the estimated lag distributions for belief in the American Dream across four explanatory variables. In other words, the plots show how responsive the American dream variable is to a shift in the each of the four explanatory variables plotted. As we expect, the effect of a shift in a predictor has diminishing effects as time passes, as shown in the lines aymptotically approaching zero. This is encouraging, but non-conclusive, evidence that the GECM model was correctly constructed.

You can access the code for this replication [here](https://github.com/LiamHall7/replication_project).

```{r cleaning and adding gecm variables, warning = FALSE, echo = FALSE}

am_dream_data <- read_dta("raw_data/belief in the american dream dataset.dta")

#code for the first graph

amer_dream <- am_dream_data %>% 
  mutate(year_decimal = map_chr(am_dream_data$yearquarter, ~ str_replace_all(., "q1", ""))) %>% 
  mutate(year_decimal = map_chr(year_decimal, ~ str_replace_all(., "q2", ".25"))) %>% 
  mutate(year_decimal = map_chr(year_decimal, ~ str_replace_all(., "q3", ".5"))) %>% 
  mutate(year_decimal = map_chr(year_decimal, ~ str_replace_all(., "q4", ".75"))) %>% 
  mutate(year_decimal = as.numeric(year_decimal)) %>% 
  mutate(amdream = as.numeric(amdream))

#code for the gecm model variables

lag_data <- amer_dream %>% 
  mutate(gini_lag = lag(ginihq, 1)) %>% 
  mutate(gini_delta = ginihq - gini_lag) %>% 
  mutate(tperiod = ceiling(as.numeric(rownames(amer_dream))/36)) %>% 
  mutate(am_lag = lag(amdream, 1)) %>% 
  mutate(am_delta = amdream - am_lag) %>%
  mutate(soc_lag = lag(socmobq, 1)) %>% 
  mutate(soc_delta = socmobq - soc_lag) %>% 
  mutate(home_lag = lag(homeown, 1))  %>% 
  mutate(home_delta = homeown - home_lag) %>% 
  mutate(mood_lag = lag(mood, 1)) %>% 
  mutate(mood_delta = mood - mood_lag) %>% 
  mutate(ics_lag = lag(ics, 1)) %>% 
  mutate(ics_delta = ics - ics_lag)


```


```{r models, results="asis", echo = FALSE}
mod1 <- lm(am_delta ~ am_lag + gini_delta + gini_lag + home_delta + home_lag + mood_delta + mood_lag + ics_delta + ics_lag + midterm + prezcamp,
           data = lag_data)

mod2 <- lm(am_delta ~ am_lag + soc_delta + soc_lag + home_delta + home_lag + mood_delta + mood_lag + ics_delta + ics_lag + midterm + prezcamp, data = lag_data)

#trying to use the coefficient errors to calculate the error 
# mod1_errors <- as.data.frame(coef(summary(mod1))[, 2]) %>% 
#   mutate(errors = coef(summary(mod1))[, 2], 
#          named = c("am_delta",
#                    "am_lag",
#                    "gini_delta",
#                    "gini_lag",
#                    "home_delta",
#                    "home_lag",
#                    "mood_delta",
#                    "mood_lag",
#                    "ics_delta",
#                    "ics_lag",
#                    "midterm",
#                    "prezcamp")) %>%  
#   dplyr::select(errors, named) %>% 
#   pivot_wider(values_from = errors, names_from = named)
  

#standard errors for LRMs


# am_l <- lag_data %>% 
#   dplyr::select(am_lag) %>% 
#   drop_na()
# 
# am_d <- lag_data %>% 
#   dplyr::select(am_delta) %>% 
#   drop_na()  
# 
# gini_l <- lag_data %>% 
#   dplyr::select(gini_lag) %>% 
#   drop_na()
# 
# gini_d <- lag_data %>% 
#   dplyr::select(gini_delta) %>% 
#   drop_na()  
# 
# soc_l <- lag_data %>% 
#   dplyr::select(soc_lag) %>% 
#   drop_na()
# 
# soc_d <- lag_data %>% 
#   dplyr::select(soc_delta) %>% 
#   drop_na()
# 
# home_l <- lag_data %>% 
#   dplyr::select(home_lag) %>% 
#   drop_na()
# 
# home_d <- lag_data %>% 
#   dplyr::select(home_delta) %>% 
#   drop_na()
# 
# mood_l <- lag_data %>% 
#   dplyr::select(mood_lag) %>% 
#   drop_na()
# 
# mood_d <- lag_data %>% 
#   dplyr::select(mood_delta) %>% 
#   drop_na()
# 
# ics_l <- lag_data %>% 
#   dplyr::select(ics_lag) %>% 
#   drop_na()
# 
# ics_d <- lag_data %>% 
#   dplyr::select(ics_delta) %>% 
#   drop_na()
# 
# mid <- lag_data %>% 
#   dplyr::select(midterm) %>% 
#   drop_na()
# 
# prez <- lag_data %>% 
#   dplyr::select(prezcamp) %>% 
#   drop_na()
# 
# B <- 1000
# 
# 
# am_l.mat <- am_d.mat <- gini_l.mat <- gini_d.mat <- soc_l.mat <- soc_d.mat <-NULL
# home_l.mat <- home_d.mat <- mood_l.mat <- mood_d.mat <- ics_l.mat <- ics_d.mat <- NULL
# mid.mat <- prez.mat <- NULL
# 
# for (i in 1:B)  {
#   
#   am_l.mat <- rbind(am_l.mat,   sample(am_l, length(am_l),
#                                                 replace=TRUE))
#   
#   am_d.mat <- rbind(am_d.mat, sample(am_d ,length(am_d),
#                                                 replace=TRUE))
#   
#   gini_l.mat <- rbind(gini_l.mat,   sample(gini_l, length(gini_l),
#                                                 replace=TRUE))
#   
#   gini_d.mat <- rbind(gini_d.mat, sample(gini_d ,length(gini_d),
#                                                 replace=TRUE))
# 
#   soc_l.mat <- rbind(soc_l.mat,   sample(soc_l, length(soc_l),
#                                                 replace=TRUE))
#   
#   soc_d.mat <- rbind(soc_d.mat, sample(soc_d, length(soc_d),
#                                                 replace=TRUE))
#   
#   home_l.mat <- rbind(home_l.mat,   sample(home_l, length(home_l),
#                                                 replace=TRUE))
#   
#   home_d.mat <- rbind(home_d.mat, sample(home_d ,length(home_d),
#                                                 replace=TRUE))
#   
#   mood_l.mat <- rbind(mood_l.mat,   sample(mood_l, length(mood_l),
#                                                 replace=TRUE))
#   
#   mood_d.mat <- rbind(mood_d.mat, sample(mood_d, length(mood_d),
#                                                 replace=TRUE))
#   
#   ics_l.mat <- rbind(ics_l.mat,   sample(ics_l, length(ics_l),
#                                                 replace=TRUE))
#   
#   ics_d.mat <- rbind(ics_d.mat, sample(ics_d, length(ics_d),
#                                                 replace=TRUE))
#   
#   mid.mat <- rbind(mid.mat,   sample(mid, length(mid),
#                                                 replace=TRUE))
#   
#   prez.mat <- rbind(prez.mat, sample(prez, length(prez),
#                                                 replace=TRUE))
#   
#   }
# 
# am_l_mean <- mean(apply(gini_l.mat, 1, mean))
# 
# am_d_mean <- mean(apply(gini_d.mat, 1, mean))
# 
# gini_l_mean <- mean(apply(gini_l.mat, 1, mean))
# 
# gini_l_mean <- mean(apply(gini_l.mat, 1, mean))
# 
# soc_d_mean <- mean(apply(gini_d.mat, 1, mean))
# 
# soc_l_mean <- mean(apply(gini_l.mat, 1, mean))
# 
# home_l_mean <- mean(apply(gini_l.mat, 1, mean))
# 
# home_d_mean <- mean(apply(gini_d.mat, 1, mean))
# 
# mood_l_mean <- mean(apply(gini_l.mat, 1, mean))
# 
# mood_l_mean <- mean(apply(gini_l.mat, 1, mean))
# 
# ics_d_mean <- mean(apply(gini_d.mat, 1, mean))
# 
# ics_l_mean <- mean(apply(gini_l.mat, 1, mean))
# 
# mid_l_mean <- mean(apply(gini_l.mat, 1, mean))
# 
# prez_d_mean <- mean(apply(gini_d.mat, 1, mean))
```

```{r lrm se, echo = FALSE}

#LRM value calculations 

#model one calculations

gini_lrm_1 <- -(mod1$coefficients[4]/mod1$coefficients[2])
home_lrm_1 <- -(mod1$coefficients[6]/mod1$coefficients[2])
mood_lrm_1 <- -(mod1$coefficients[8]/mod1$coefficients[2])
ics_lrm_1 <- -(mod1$coefficients[10]/mod1$coefficients[2])

#model two calculations

soc_lrm_2 <- -(mod2$coefficients[4]/mod2$coefficients[2])
home_lrm_2 <- -(mod2$coefficients[6]/mod2$coefficients[2])
mood_lrm_2 <- -(mod2$coefficients[8]/mod2$coefficients[2])
ics_lrm_2 <- -(mod2$coefficients[10]/mod2$coefficients[2])


#LRM is  negative ratio of the coefficients
#https://lib.dr.iastate.edu/cgi/viewcontent.cgi?article=1059&context=pols_pubs


#LRM standard error calculations

#model one calculations

gini_lrm_se_1 <- deltamethod(~x4/x2, coef(mod1), vcov(mod1))
home_lrm_se_1 <- deltamethod(~x6/x2, coef(mod1), vcov(mod1))
mood_lrm_se_1 <- deltamethod(~x8/x2, coef(mod1), vcov(mod1))
ics_lrm_se_1 <- deltamethod(~x10/x2, coef(mod1), vcov(mod1))

#model two calculations

soc_lrm_se_2 <- deltamethod(~x4/x2, coef(mod2), vcov(mod2))
home_lrm_se_2 <- deltamethod(~x6/x2, coef(mod2), vcov(mod2))
mood_lrm_se_2 <- deltamethod(~x8/x2, coef(mod2), vcov(mod2))
ics_lrm_se_2 <- deltamethod(~x10/x2, coef(mod2), vcov(mod2))

#alternative method for standard error calculations - bootstrapping
#slide 36 in week 11_MC

#t values for LRMs

#model one calculations

gini_lrm_t_1 <- gini_lrm_1/gini_lrm_se_1
home_lrm_t_1 <- home_lrm_1/home_lrm_se_1
mood_lrm_t_1 <- mood_lrm_1/mood_lrm_se_1
ics_lrm_t_1 <- ics_lrm_1/ics_lrm_se_1

#model two calculations

soc_lrm_t_2 <- soc_lrm_2/soc_lrm_se_2
home_lrm_t_2 <- home_lrm_2/home_lrm_se_2
mood_lrm_t_2 <- mood_lrm_2/mood_lrm_se_2
ics_lrm_t_2 <- ics_lrm_2/ics_lrm_se_2


```


```{r results = 'asis', echo=FALSE,  fig.align="center", fig.width=7, fig.height=9}

names <- c("Belief in the American Dream$_{t-1}$",
     "$\\Delta$ Gini coefficient",
     "Gini coefficient$_{t-1}$",
     "$\\Delta$ Social mobility",
     "Social mobility$_{t-1}$",
     "$\\Delta$ Homeownership",
     "Homeownership$_{t-1}$",
     "$\\Delta$ Policy mood",
     "Policy mood$_{t-1}$",
     "$\\Delta$ Index of consumer sentiment",
     "Index of consumer sentiment$_{t-1}$",
     "Midterm election",
     "Presidential campaign",
     "Constant")

stargazer(mod1, mod2,
          header = FALSE,
          column.labels = c("Model 1", "Model 2"),
          title = "Explaining Belief in the American Dream",
          dep.var.labels = "$\\Delta$ in Belief in the American Dream",
          covariate.labels = names,
          #style = "aer",
          #column.sep.width = "0pt",
          model.numbers = FALSE,
          no.space = TRUE,
          font.size = "small",
          omit.stat = c("f", "ser", "adj.rsq"),
          notes = c("$\\dagger$ denotes significant LRMs, where t-value exceeds
                    absolute value of 3.560",
                    "standard errors wrapped in parentheses"),
          add.lines = list(c("$\t{Long}$ $\t{run}$ $\t{multipliers}$", "", ""),
                           c("LRM, Gini coefficient", "-108.1521$\\dagger$",""),
                           c("standard error", "(26.9571)", ""),
                           c("t-value", "-4.0120", ""),
                           #c("","",""),
                           c("LRM, Social mobility", "", "26.3578$\\dagger$"),
                           c("  standard error", "", "(6.9230)"),
                           c("  t-value", "", "3.8073"),
                           #c("","",""),
                           c("LRM, Home ownership", "2.4165$\\dagger$",
                             "2.0295$\\dagger$"),
                           c("  standard error", "(.4556)", "(.4571)"),
                           c("  t-value", "5.3041", "4.4403"),
                           #c("","",""),
                           c("LRM, Policy mood", ".2394", ".3111"),
                           c("  standard error", "(.1750)", "(.1791)"),
                           c("  t-value", "1.3681", "1.7370"),
                           #c("","",""),
                           c("LRM, Index of consumer sentiment",
                             ".2527$\\dagger$", ".2258$\\dagger$"),
                           c("  standard error", "(.0578)", "(.0560)"),
                           c("  t-value", "4.3723", "3.7635"),
                           c("","","")))


```

## Extensions

As mentioned earlier, treating the respective stationarities of the different variables properly is crucial in yielding accurate results from the GECM model. However, as Webb, Linn, and Lebo (2019, 2020) have explored and documented, the many different tests for stationarity are low-powered and can yield unreliable stationarity assessments. Instead of relying on these tests, Wolak and Peterson judged the stationarity of the variables post-hoc, by using the methods suggested by Webb, Linn, and Lebo to assess their LRM significances: For the given model with k = 2 and n = 150, t-values above the upper bound of |3.56| were deemed statistically significant with t-values below |3.56| deemed insignificant. I applied the same reasoning in my own analysis and reached the same conclusions: that the gini coefficient, social mobility, home ownership rates, and consumer confidence all had significant long term relationships with belief in the American dream. In terms of stationarity, this would suggest that the variables with a statistically significant long run relationship with American dream were also non-stationary, since a stationary variable would be too consistent to have a long run multiplier effect. However, extending from the original model, I also measured the stationarity of variables by the Phillips-Perron Test, documented in Table 4, and visualize and compare the stationarity of two different variables, gini coefficient and presidential campaign cycle. More on this in a moment.

The first of my extensions was to bootstrap the standard errors and compare them to the standard errors output by the two models. Tables 2 and 3 displays the comparison between the different calculated standard errors. This extension does not help develop greater understanding of the original paper, but was a different way of calculating the standard errors than the original paper used. Ultimately, as you can see in the tables, the errors were very similar between the two methods.

The second and more notable extension was to examine the stationarity of the different variables. Table 3 displays each variables's results for the Phillips-Perron Stationarity test. As mentioned earlier, the Phillips-Perron test as well as the other stationarity tests yield stationarity assessments of varying accuracy. The purpose of including the Phillips-Perron test output in this case was not to arrive at a conclusive stationarity assessment, but to compare the assessment results with the different variables' plots and their residuals, which is graphed in Figure 2, with the hope that pairing the test conclusions with the visuals might help suggest the stationarity of the variable.

Figure 1 is a plot of belief in the American Dream over time, as was included in the original paper but with a linear regression overlay. If we think of stationarity as the degree to which the values are stationary, or fixed and predictable in value, then we would image a variable behaving in a consistent and reliable way. The three types of stationarity are based on how consistent and reliable the variable's behavior is. The three types of stationarity are no drift (i.e. oscillation or wavering) and no trend (i.e. linear regression with slope of 0), with drift and no trend, and drift and trend. Table 4 displays the Phillips-Perron stationarity assessments for each variable, along with the each variables' p-values for these different types of stationarity. According to the test, when the p-value is above .05, we reject the null hypothesis and assume non-stationarity. Rather than going through each individual variable, I chose to look at one variable that is treated like a stationary variable in the model, presidential campaign cycle, and one that's treated like a non-stationary variable, the gini coefficient (see figure 2). In class, we used residual plots to assess model fits. I employed residual plots in this case to help visualize potential stationarity.

The gini coefficient's Phillips-Perron p-values suggest that the variable is non-stationary in all types, because it's p-values all exceed .05. Looking at the gini plots in figure 2, the variable's behavior visually matches what we would expect from the test's assessments: a steady non-zero positive trend and its residuals do not evenly oscillate around 0, suggesting the variable is in fact non stationary. Turning to the presidential campaign variable, the test assessments suggest the variable is stationary in all three types. However, looking at the presidential campaign plots in figure 2, we see that while the linear regression has a slope of around 0, the residuals do not oscillate around 0 evenly. We also know that the presidential campaign cycle occurs every 4 years, and therefore its behavior would be determined from time. In other words, there is seasonality, which would suggest the variable is not stationary by the type 1 standards, but is stationary by the type 2 and type 3 standards. For the purposes of the GECM model, the gini coefficient should be treated like a non-stationary variable and the presidential campaign variable (prezcamp) should be treated as a stationary variable, which the original authors did, albeit due to different reasoning mentioned earlier (i.e. by checking the statistical significance of its LRM according to its t-value, because stationary variables cannot have a long run effect - they don't change enough to cause one).

The third extension I did was to display the distribution of changes in American dream belief between time periods (quarter years). Because very small oscillations around a mean would suggest that belief in the American dream is not truly correlated with the variables as much as the model might suggest (i.e. the variables' behavior might be more determined by human error than statistical significance). I found that the distribution of change in belief in the American dream between quarters was roughly similar to a normal distribution with its standard deviation of 3.660072 and average value of -.0202787, suggesting that the variations in American dream values were likely sizeable enough to have a statistically significant relationship with the explanatory variables.

```{r bootstrapping, results="asis", echo = FALSE}

options(xtable.comment = FALSE)

boot_function <- function(data, i, formula){
  d <- data[i, ]
  obj <- lm(formula, d)
  coef(obj)
  
  #coefs <- summary(obj)$coefficients
  #coefs[, 1] # the second row is the standard errors
}

set.seed(6)

#model 1 bootstrapped errors

se_booted_1 <- boot(lag_data, boot_function, R = 1000, 
     formula = am_delta ~ am_lag + gini_delta + gini_lag + home_delta +
       home_lag + mood_delta + mood_lag + ics_delta + ics_lag + midterm +
       prezcamp)

se_boot_1 <- as.data.frame(apply(se_booted_1$t, 2, sd))
se_orig_1 <- summary(mod1)$coef[,2]

se_comp_mod1 <- as.data.frame(cbind(se_boot_1, se_orig_1)) %>% 
  clean_names() %>% 
  rename(original = se_orig_1,
         bootstrapped = "apply_se_booted_1_t_2_sd") %>% 
  mutate(variable = rownames(.)) %>% 
  dplyr::select(original, bootstrapped) %>% 
  mutate(pct_diff = (original-bootstrapped)/original)


#model 2 bootstrapped errors

se_booted_2 <- boot(lag_data, boot_function, R = 1000, 
     formula = am_delta ~ am_lag + soc_delta + soc_lag + home_delta +
       home_lag + mood_delta + mood_lag + ics_delta + ics_lag + midterm +
       prezcamp)

se_boot_2 <- as.data.frame(apply(se_booted_2$t, 2, sd))
se_orig_2 <- summary(mod2)$coef[,2]

se_comp_mod2 <- as.data.frame(cbind(se_boot_2, se_orig_2)) %>% 
  clean_names() %>%
  rename(original = se_orig_2,
         bootstrapped = "apply_se_booted_2_t_2_sd") %>% 
  mutate(variable = rownames(.)) %>% 
  dplyr::select(original, bootstrapped) %>% 
  mutate(pct_diff = (original-bootstrapped)/original)

 print(xtable(se_comp_mod1, caption = "Model One Standard Error vs. Bootstrapped Standard Errors"),
       caption.placement = "top")
 
 print(xtable(se_comp_mod2, caption = "Model Two Standard Error vs. Bootstrapped Standard Errors"),
       caption.placement = "top")


```


\newpage

```{r stationarity, include = FALSE, warning=FALSE}
options(xtable.comment = FALSE)

mod1_data <- lag_data %>% 
  dplyr::select(year_decimal, amdream, ginihq, homeown, mood, ics, midterm, prezcamp) %>% 
  drop_na()

mod2_data <- lag_data %>% 
  dplyr::select(year_decimal, amdream, socmobq, homeown, mood, ics, midterm, prezcamp) %>% 
  drop_na()

am_ts <- ts(mod1_data$amdream, start = 1973, frequency = 4)

gini_ts <- ts(mod1_data$ginihq, start = 1973, frequency = 4)

soc_ts <-  ts(mod2_data$socmobq, start = 1973, frequency = 4)

home_ts <- ts(mod1_data$homeown, start = 1973, frequency = 4)

mood_ts <- ts(mod1_data$mood, start = 1973, frequency = 4)

ics_ts <- ts(mod1_data$ics, start = 1973, frequency = 4)

midterm_ts <- ts(mod1_data$midterm, start = 1973, frequency = 4)

prezcamp_ts <- ts(mod1_data$prezcamp, start = 1973, frequency = 4)


#check for stationarity

#stationary means that it does not change with time - its not cyclical

pp_am <- as.data.frame(pp.test(am_ts))
#non-stationary

pp_g <- as.data.frame(pp.test(gini_ts))
#non-stationary

pp_s <- as.data.frame(pp.test(soc_ts))
#non-stationary

pp_h <- as.data.frame(pp.test(home_ts))
#non-stationary

pp_m <- as.data.frame(pp.test(mood_ts))
#non-stationary

pp_i <- as.data.frame(pp.test(ics_ts))
#non-stationary

pp_mid <- as.data.frame(pp.test(midterm_ts))
#stationary

pp_prez <- as.data.frame(pp.test(prezcamp_ts)) 
#stationary
```



```{r stationarity table, echo = FALSE, warning=FALSE, results="asis"}

pp_data <- rbind(pp_am, pp_g, pp_s, pp_h, pp_m, pp_i, pp_mid, pp_prez) %>% 
  mutate(variable = c("American Dream",
                      "American Dream",
                      "American Dream",
                      "Gini",
                      "Gini",
                      "Gini",
                      "Social Mobility",
                      "Social Mobility",
                      "Social Mobility",
                      "Home Ownership",
                      "Home Ownership",
                      "Home Ownership",
                      "Policy Mood",
                      "Policy Mood",
                      "Policy Mood",
                      "Consumer Confidence",
                      "Consumer Confidence",
                      "Consumer Confidence",
                      "Midterm Election",
                      "Midterm Election",
                      "Midterm Election",
                      "Presidential Election",
                      "Presidential Election",
                      "Presidential Election")) %>% 
  
  mutate(type = c("Type 1: no drift, no trend",
                  "Type 2: with drift, no trend",
                  "Type 3: with drift, and trend",
                  "Type 1: no drift, no trend",
                  "Type 2: with drift, no trend",
                  "Type 3: with drift, and trend",
                  "Type 1: no drift, no trend",
                  "Type 2: with drift, no trend",
                  "Type 3: with drift, and trend",
                  "Type 1: no drift, no trend",
                  "Type 2: with drift, no trend",
                  "Type 3: with drift, and trend",
                  "Type 1: no drift, no trend",
                  "Type 2: with drift, no trend",
                  "Type 3: with drift, and trend",
                  "Type 1: no drift, no trend",
                  "Type 2: with drift, no trend",
                  "Type 3: with drift, and trend",
                  "Type 1: no drift, no trend",
                  "Type 2: with drift, no trend",
                  "Type 3: with drift, and trend",
                  "Type 1: no drift, no trend",
                  "Type 2: with drift, no trend",
                  "Type 3: with drift, and trend")) %>% 
  dplyr::select(type, Z_rho, p.value)

row.names(pp_data) <- NULL

kable(pp_data, caption = "Variable Stationarities",
      col.names = c("Variable", "Z_rho", "p-value"),
      format = "latex",
      booktabs = T) %>%
    kable_styling(latex_options = "striped") %>%
    group_rows("American Dream", 1, 3) %>%
    group_rows("Gini Coefficient", 4, 6) %>%
    group_rows("Social Mobility", 7, 9) %>%
    group_rows("Home Ownership", 10, 12) %>% 
    group_rows("Policy Mood", 13, 15) %>%
    group_rows("Consumer Confidence", 16, 18) %>% 
    group_rows("Midterm Election", 19, 21) %>%
    group_rows("Presidential Election", 22, 24) 

```

```{r stationarity plots pt 1, echo = FALSE, warning=FALSE, fig.align="center", fig.width=7, fig.height=5}

am_plot <- lag_data %>% 
  ggplot(aes(year_decimal, amdream)) + 
  geom_line() +
  geom_line(stat = "smooth",
            formula = y ~ x,
            color = "royalblue1",
            method = "loess") +
  theme_classic() +
  scale_y_continuous(breaks = seq(from = 0, to = 70, by = 10),
                     limits = c(0, 70)) +
  scale_x_continuous(breaks = seq(from = 1973, to = 2018, by = 3),
                     limits = c(1973, 2019),
                     labels = seq(from = 1973, to = 2018, by = 3)) +
  #because labels vector has to be same length as breaks vector, it wasn't
  #possible to make three ticks on the x axis for every label
  
  theme(axis.line = element_line(color = "grey85"),
        axis.ticks = element_line(color = "grey85"),
        axis.ticks.length = unit(-3, "pt"),
        axis.text.x = element_text(margin = margin(t = 15, "pt"),
                                   family = "Century"),
        axis.text.y = element_text(margin = margin(r = 10, "pt"),
                                   family = "Century"),
        
        axis.title.x = element_text(family = "Century"),
        axis.title.y = element_text(family = "Century"),
        
        plot.title = element_text(face = "bold",
                                  size = 13,
                                  family = "Century")) +
  
  labs(y = "Public Belief in the American Dream",
       x = "Time (year by quarter)",
       title = "Figure 1: The Dynamics of Public Belief in the American Dream")

am_plot


```


```{r stationarity plots pt 2, echo = FALSE, warning=FALSE, fig.show='hold'}

gini_stat_plot <- lag_data %>% 
  dplyr::select(year_decimal, ginihq) %>% 
  drop_na() %>% 
  ggplot(aes(year_decimal, ginihq)) + 
  geom_line() +
  geom_line(stat = "smooth",
            formula = y ~ x,
            color = "royalblue1",
            method = "loess") +
  theme_classic() +
  
  scale_y_continuous(breaks = seq(from = .37, to = .5, by = .03),
                     limits = c(.37, .5)) +
  scale_x_continuous(breaks = seq(from = 1973, to = 2018, by = 6),
                     limits = c(1973, 2019),
                     labels = seq(from = 1973, to = 2018, by = 6)) +
  theme(axis.line = element_line(color = "grey85"),
        axis.ticks = element_line(color = "grey85"),
        axis.ticks.length = unit(-3, "pt"),
        axis.text.x = element_text(margin = margin(t = 15, "pt"),
                                   family = "Century"),
        axis.text.y = element_text(margin = margin(r = 5, "pt"),
                                   family = "Century"),
        axis.title.x = element_text(family = "Century"),
        axis.title.y = element_text(family = "Century", 
                                    size = 8),
        plot.title = element_text(face = "bold",
                                  size = 10,
                                  family = "Century")) +
  
  # ylim(0, 70) +
  # xlim(1973, 2019) + 
  labs(x = "Year (by quarter)",
       y = "Gini Coefficient",
       title = "American Gini coefficient over Time")


gini_mod <- lm(ginihq ~ year_decimal, data = lag_data)

gini_data <- augment(gini_mod)

gini_resid <- ggplot(gini_data, aes(x = .fitted, y = .resid)) +
  geom_line()  +
  geom_abline(intercept = 0, slope = 0, color = "royalblue1") +
  theme_classic() +
  
  # scale_y_continuous(breaks = seq(from = -.15, to = .15, by = .01),
  #                    limits = c(.37, .5)) +
  # scale_x_continuous(breaks = seq(from = 1973, to = 2018, by = 3),
  #                    limits = c(1973, 2019),
  #                    labels = seq(from = 1973, to = 2018, by = 3)) +
  
  theme(axis.line = element_line(color = "grey85"),
        axis.ticks = element_line(color = "grey85"),
        axis.ticks.length = unit(-3, "pt"),
        axis.text.x = element_text(margin = margin(t = 15, "pt"),
                                   family = "Century"),
        axis.text.y = element_text(margin = margin(r = 5, "pt"),
                                   family = "Century"),
        axis.title.x = element_text(family = "Century"),
        axis.title.y = element_text(family = "Century"),
        plot.title = element_text(face = "bold",
                                  size = 10,
                                  family = "Century")) +
  labs(x = "Fitted",
       y = "Residual",
       title = "Gini Residuals")


prez_stat_plot <- lag_data %>% 
  dplyr::select(year_decimal, prezcamp) %>% 
  drop_na() %>% 
  ggplot(aes(year_decimal, prezcamp)) + 
  geom_line() +
  geom_line(stat = "smooth",
            formula = y ~ x,
            color = "royalblue1",
            method = "loess") +
  theme_classic() +
  
  scale_y_continuous(breaks = seq(from = 0, to = 4, by = 1),
                     limits = c(0, 4)) +
  scale_x_continuous(breaks = seq(from = 1973, to = 2018, by = 6),
                     limits = c(1973, 2019),
                     labels = seq(from = 1973, to = 2018, by = 6)) +
    
  # ylim(0, 70) +
  # xlim(1973, 2019) + 
  labs(x = "Year (by quarter)",
       y = "Quarter of Presidential Campaign",
       title = "American Presidential Campaign Cycles over Time") +
  
  theme(axis.line = element_line(color = "grey85"),
        axis.ticks = element_line(color = "grey85"),
        axis.ticks.length = unit(-3, "pt"),
        axis.text.x = element_text(margin = margin(t = 15, "pt"),
                                   family = "Century"),
        axis.text.y = element_text(margin = margin(r = 5, "pt"),
                                   family = "Century"),
        axis.title.x = element_text(family = "Century"),
        axis.title.y = element_text(family = "Century",
                                    size = 8),
        plot.title = element_text(face = "bold",
                                  size = 10,
                                  family = "Century"))

prez_mod <- lm(prezcamp ~ year_decimal, data = lag_data)

prez_data <- augment(prez_mod)

prez_resid <- ggplot(prez_data, aes(x = .fitted, y = .resid)) +
  geom_line()  +
  geom_abline(intercept = 0,
              slope = 0,
              color = "royalblue1") +
  theme_classic() +
  
  # scale_y_continuous(breaks = seq(from = -.15, to = .15, by = .01),
  #                    limits = c(.37, .5)) +
  # scale_x_continuous(breaks = seq(from = 1973, to = 2018, by = 3),
  #                    limits = c(1973, 2019),
  #                    labels = seq(from = 1973, to = 2018, by = 3)) +
  theme(axis.line = element_line(color = "grey85"),
        axis.ticks = element_line(color = "grey85"),
        axis.ticks.length = unit(-3, "pt"),
        axis.text.x = element_text(margin = margin(t = 15, "pt"),
                                   family = "Century"),
        axis.text.y = element_text(margin = margin(r = 5, "pt"),
                                   family = "Century"),
        axis.title.x = element_text(family = "Century"),
        axis.title.y = element_text(family = "Century"),
        plot.title = element_text(face = "bold",
                                  size = 10,
                                  family = "Century")) +
  labs(x = "Fitted",
       y = "Residual",
       title = "President Campaign Residuals")

stat_plots <- ggarrange(gini_stat_plot, gini_resid, prez_stat_plot, prez_resid)  

grid.arrange(stat_plots, 
             top = "Figure 2: Gini and Presidential Campaign Stationarities")

```

\newpage

```{r stationary tables alternative, results = "asis", include=FALSE, warning = FALSE}

# print(xtable(pp_am, digits = 4, caption = "American Dream Stationarity"),
#       caption.placement = "top")
# 
# print(xtable(pp_g, digits = 4, caption = "Gini Coefficient Stationarity"), 
#       caption.placement = 'top')
# 
# print(xtable(pp_h, digits = 4, caption = "Home Ownership Rate Stationarity"), 
#       caption.placement = 'top')
# 
# print(xtable(pp_m, digits = 4, caption = "Public Policy Mood Stationarity"), 
#       caption.placement = 'top')
# 
# print(xtable(pp_i, digits = 4, caption = "Consumer Confidence Stationarity"), 
#       caption.placement = 'top')
# 
# print(xtable(pp_mid, digits = 4, caption = "Midterm Election Stationarity"), 
#       caption.placement = 'top')
# 
# print(xtable(pp_prez, digits = 4, caption = "Presidential Election Stationarity"), 
#       caption.placement = 'top')
# 
# kable(, format = "latex", caption = "Group Rows", booktabs = T) %>%
#     kable_styling() %>%
#     group_rows("Group 1", 4, 7) %>%
#     group_rows("Group 2", 8, 10)

```


```{r fig 2 data, echo = FALSE, results="asis"}

mod1_coefs <- as.data.frame(mod1$coefficients) %>% 
  rownames_to_column("VALUE") %>% 
  pivot_wider(names_from = VALUE, values_from = "mod1$coefficients")


mod2_coefs <- as.data.frame(mod2$coefficients) %>% 
  rownames_to_column("VALUE") %>% 
  pivot_wider(names_from = VALUE, values_from = "mod2$coefficients")


tiblet <- tibble(t = c(0:5),
       gini = NA,
       soc = NA,
       home = NA,
       ics = NA)

#Variable Responsiveness over lagged periods

tiblet$gini[1] <- mod1_coefs$gini_delta/100
tiblet$gini[2] <- ((gini_lrm_1/100 - tiblet$gini[1]) * -(mod1_coefs$am_lag))
tiblet$gini[3] <- ((gini_lrm_1/100 - tiblet$gini[1] - tiblet$gini[2]) * -(mod1_coefs$am_lag))
tiblet$gini[4] <- ((gini_lrm_1/100 - tiblet$gini[1] - tiblet$gini[2] - tiblet$gini[3]) * -(mod1_coefs$am_lag))
tiblet$gini[5] <- ((gini_lrm_1/100 - tiblet$gini[1] - tiblet$gini[2] - tiblet$gini[3] - tiblet$gini[4]) * -(mod1_coefs$am_lag))
tiblet$gini[6] <- ((gini_lrm_1/100 - tiblet$gini[1] - tiblet$gini[2] - tiblet$gini[3] - tiblet$gini[4] - tiblet$gini[5]) * -(mod1_coefs$am_lag))

tiblet$soc[1] <- mod2_coefs$soc_delta/100
tiblet$soc[2] <- ((soc_lrm_2/100 - tiblet$soc[1]) * -(mod2_coefs$am_lag))
tiblet$soc[3] <- ((soc_lrm_2/100 - tiblet$soc[1] - tiblet$soc[2]) * -(mod2_coefs$am_lag))
tiblet$soc[4] <- ((soc_lrm_2/100 - tiblet$soc[1] - tiblet$soc[2] - tiblet$soc[3]) * -(mod2_coefs$am_lag))
tiblet$soc[5] <- ((soc_lrm_2/100 - tiblet$soc[1] - tiblet$soc[2] - tiblet$soc[3] - tiblet$soc[4]) * -(mod2_coefs$am_lag))
tiblet$soc[6] <- ((soc_lrm_2/100 - tiblet$soc[1] - tiblet$soc[2] - tiblet$soc[3] - tiblet$soc[4] - tiblet$soc[5]) * -(mod2_coefs$am_lag))

tiblet$home[1] <- mod1_coefs$home_delta
tiblet$home[2] <- ((home_lrm_1 - tiblet$home[1]) * -(mod1_coefs$am_lag))
tiblet$home[3] <- ((home_lrm_1 - tiblet$home[1] - tiblet$home[2]) * -(mod1_coefs$am_lag))
tiblet$home[4] <- ((home_lrm_1 - tiblet$home[1] - tiblet$home[2] - tiblet$home[3]) * -(mod1_coefs$am_lag))
tiblet$home[5] <- ((home_lrm_1 - tiblet$home[1] - tiblet$home[2] - tiblet$home[3] - tiblet$home[4]) * -(mod1_coefs$am_lag))
tiblet$home[6] <- ((home_lrm_1 - tiblet$home[1] - tiblet$home[2] - tiblet$home[3] - tiblet$home[4] - tiblet$home[5]) * -(mod1_coefs$am_lag))

tiblet$ics[1] <- mod1_coefs$ics_delta
tiblet$ics[2] <- ((ics_lrm_1 - tiblet$ics[1]) * -(mod1_coefs$am_lag))
tiblet$ics[3] <- ((ics_lrm_1 - tiblet$ics[1] - tiblet$ics[2]) * -(mod1_coefs$am_lag))
tiblet$ics[4] <- ((ics_lrm_1 - tiblet$ics[1] - tiblet$ics[2] - tiblet$ics[3]) * -(mod1_coefs$am_lag))
tiblet$ics[5] <- ((ics_lrm_1 - tiblet$ics[1] - tiblet$ics[2] - tiblet$ics[3] - tiblet$ics[4]) * -(mod1_coefs$am_lag))
tiblet$ics[6] <- ((ics_lrm_1 - tiblet$ics[1] - tiblet$ics[2] - tiblet$ics[3] - tiblet$ics[4] - tiblet$ics[5]) * -(mod1_coefs$am_lag))
```

 
```{r fig 2, results= "asis", echo = FALSE, fig.align="center", fig.width=7, fig.height=4.5}

gini_plot <- tiblet %>% 
  ggplot() +
  geom_line(aes(y = gini, x = t), color = "darkgray") +
  geom_abline(intercept = 0, slope = 0) +
  labs(y = "Effect on Y",
       x = "Time Period", 
       title = "Gini Coefficient") +
  scale_y_continuous(breaks = seq(from = -4.00, to = 2.00, by = 1.00),
                     limits = c(-4.00, 2.00),
                     labels = scales::comma) +
  theme_classic() +
  theme(axis.line = element_line(color = "black"),
        axis.ticks = element_line(color = "black"),
        axis.text.x = element_text(family = "Century",
                                   size = 8),
        axis.text.y = element_text(family = "Century",
                                   size = 7),
        axis.title.x = element_text(family = "Century",
                                    size = 8),
        axis.title.y = element_text(family = "Century",
                                    size = 8),
        plot.title = element_text(hjust = .5,
                                  size = 8,
                                  family = "Century"))

soc_plot <- tiblet %>% 
  ggplot() +
  geom_line(aes(y = soc, x = t), color = "darkgray") +
  geom_abline(intercept = 0, slope = 0) +
  theme_classic() +
  theme(axis.line = element_line(color = "black"),
        axis.ticks = element_line(color = "black"),
        axis.text.x = element_text(family = "Century",
                                   size = 8),
        axis.text.y = element_text(family = "Century",
                                   size = 7),
        axis.title.x = element_text(family = "Century",
                                    size = 8),
        axis.title.y = element_text(family = "Century",
                                    size = 8),
        plot.title = element_text(hjust = .5,
                                  size = 8,
                                  family = "Century")) +
  
  scale_y_continuous(breaks = seq(from = -.40, to = 1.4, by = .20),
                     limits = c(-.40, 1.4),
                     labels = scales::comma) +
  
  labs(title = "Social mobility",
       x = "Time period",
       y = "Effect on Y")

home_plot <- tiblet %>% 
  ggplot() +
  geom_line(aes(y = home, x = t), color = "darkgray") +
  geom_abline(intercept = 0, slope = 0) +
  theme_classic() +
  theme(axis.line = element_line(color = "black"),
        axis.ticks = element_line(color = "black"),
        axis.text.x = element_text(family = "Century",
                                   size = 8),
        axis.text.y = element_text(family = "Century",
                                   size = 8),
        axis.title.x = element_text(family = "Century",
                                    size = 8),
        axis.title.y = element_text(family = "Century",
                                    size = 8),
        plot.title = element_text(hjust = .5,
                                  size = 8,
                                  family = "Century")) +
  
  scale_y_continuous(breaks = seq(from = -.20, to = 1.0, by = .20),
                     limits = c(-.20, 1.0),
                     labels = scales::comma) +
  
  labs(title = "Home ownership",
       x = "Time period",
       y = "Effect on Y")

ics_plot <- tiblet %>% 
  ggplot() +
  geom_line(aes(y = ics, x = t), color = "darkgray") +
  geom_abline(intercept = 0, slope = 0) +
  theme_classic() +
  theme(axis.line = element_line(color = "black"),
        axis.ticks = element_line(color = "black"),
        axis.text.x = element_text(family = "Century",
                                   size = 8),
        axis.text.y = element_text(family = "Century",
                                   size = 8),
        axis.title.x = element_text(family = "Century",
                                    size = 8),
        axis.title.y = element_text(family = "Century",
                                    size = 8),
        plot.title = element_text(hjust = .5,
                                  size = 8,
                                  family = "Century")) +
  
   scale_y_continuous(breaks = seq(from = -.04, to = .12, by = .02),
                     limits = c(-.04, .12)) +
  
  labs(title = "Index of Consumer Sentiment",
       x = "Time period",
       y = "Effect on Y")


# title <- text_grob("Figure 2: Estimated Lag Distributions for Belief in the American Dream",
#           size = 10,
#           family = "Times New Roman",
#           face = "bold")
# 
# plot_title <- as_ggplot(title) +
#   theme(plot.margin = margin(0,3,0,0, "cm"))


plots <- ggarrange(gini_plot, soc_plot, home_plot, ics_plot)  

grid.arrange(plots, 
             top = "Figure 3: Estimated Lag Distributions for Belief in the American Dream")

# annotate_figure(plots,
#                 top = text_grob("Figure 2: Estimated Lag Distributions for Belief in the American Dream",
#                                 size = 10, face = "bold", family = "Times New Roman"))

```

```{r am delta distibution plot, echo = FALSE, results = "asis", warning=FALSE, fig.align="center", fig.width=7, fig.height=4.5}

delta_data <- lag_data %>% 
  dplyr::select(am_delta) %>% 
  drop_na()
  
am_delta_dist <- delta_data %>% 
  ggplot(aes(x = am_delta)) +
  geom_histogram(aes(y = ..density..), color = "white", bins = 30) +
  stat_function(fun = dnorm, args = list(mean = mean(delta_data$am_delta), sd = sd(delta_data$am_delta)), position = "identity", color = "limegreen") +
  theme_classic() +
  # 
  # scale_y_continuous(breaks = seq(from = 0, to = 4, by = .5),
  #                    limits = c(0, 4)) +
  # scale_x_continuous(breaks = seq(from = 1973, to = 2018, by = 3),
  #                    limits = c(1973, 2019),
  #                    labels = seq(from = 1973, to = 2018, by = 3)) +

  theme(axis.line = element_line(color = "grey85"),
        axis.ticks = element_line(color = "grey85"),
        axis.ticks.length = unit(-3, "pt"),
        axis.text.x = element_text(margin = margin(t = 15, "pt"),
                                   family = "Century"),
        axis.text.y = element_text(margin = margin(r = 5, "pt"),
                                   family = "Century"),
        axis.title.x = element_text(family = "Century"),
        axis.title.y = element_text(family = "Century"),
        plot.title = element_text(face = "bold",
                                  size = 14,
                                  family = "Century")) +
  
  # ylim(0, 70) +
  # xlim(1973, 2019) + 

  labs(x = "Change in American Dream (between quarters)",
       y = "Frequency",
       title = "Figure 4: Distribution of Change in Belief in American Dream")


am_delta_dist

```
\newpage

## Acknowledgements

This paper was helped in large part by the generous and helpful advice of my TF, Le Bao, and my professor, Prof. Jeff Gill.

## Bibliography (in order of reference)

Wolak, Jennifer, & Peterson, David A. M. (2020). The Dynamic American Dream. *American Journal of Political Science*, 64(4), 968-981.\

Bannerjee, Anindya, Juan Dolado, JohnW. Galbraith, and David F. Hendry. 1993.*Integration, Error Correction, and the Econometric Analysis of Non-Stationary Data*. Oxford: Oxford University Press.\

De Boef, Suzanna, and Luke Keele. 2008. “Taking Time Seriously.” *American Journal of Political Science* 52(1): 184–200.\

Nieman, Mark David, & Peterson, David A. M. (2019).\

Webb, Clayton, Suzanna Linn, and Matthew Lebo. 2020. “Beyond the Unit Root Question: Uncertainty and Inference.” *American Journal of Political Science* 64(2): 275–92.

Webb, Clayton, Linn, Suzanna, & Lebo, Matthew. (2019). A Bounds Approach to Inference Using the Long Run Multiplier. *Political Analysis*, 27(3), 281-301.


